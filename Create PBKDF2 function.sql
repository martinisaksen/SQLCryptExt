/*
 --------- TEST FOR SQLCLR on SQL Server 2017 (Windows and Linux) ---------

By: Solomon Rutzky
On: 2017-08-04
Location: https://pastebin.com/vY9GgH8F
Related blog post: https://SqlQuantumLeap.com/2017/08/09/sqlclr-vs-sql-server-2017-part-2-clr-strict-security-solution-1/

Description: This script shows a technique for deploying SQLCLR Assemblies to SQLCLR 2017
             while both keeping "clr strict security" enabled and "TRUSTWORTHY" disabled,
             AND while being fulled contained within a SQL script, AND working with SSDT.

             The trick is to first create a separate Project / Assembly that is empty but
             is also signed. That will be used to create the Asymmetric Key in [master].

             The second part of the trick is to also sign that empty Assembly with a
             Certificate. This will allow for the empty Assembly to be created.

             For a detailed, step-by-step explanation, please see the relatd blog post
             noted above.
*/



USE [master];
SET NOCOUNT ON;
GO

IF (DB_ID(N'ApproveMe') IS NULL) 
BEGIN
	PRINT 'Creating Database...';
	CREATE DATABASE [ApproveMe];
END;

IF (DB_ID(N'ApproveMe') IS NOT NULL) 
BEGIN
	PRINT 'Altering Database...';
	ALTER DATABASE [ApproveMe]
		SET RECOVERY SIMPLE,
		TRUSTWORTHY OFF;
END;


PRINT 'Making sure that SQLCLR is enabled...';
EXEC sp_configure N'clr enabled', 1; RECONFIGURE;

PRINT 'Making sure that SQLCLR "strict security" is enabled...';
EXEC sp_configure N'show advanced options', 1; RECONFIGURE;
EXEC sp_configure N'clr strict security', 1; RECONFIGURE;




IF (SUSER_ID(N'SQL2017-ClrStrictSecurity-Login') IS NULL)
BEGIN
	PRINT 'Permission Login does NOT exist:';

	IF (CERT_ID(N'SQL2017-ClrStrictSecurity-Cert') IS NULL)
	BEGIN
		PRINT 'Creating Certificate...';
		CREATE CERTIFICATE [SQL2017-ClrStrictSecurity-Cert]
FROM BINARY = 0x\
30820314308201FCA003020102021013544116E573398548BDFCCCCC992511300D06092A864886F7\
0D01010B050030163114301206035504030C0B53514C746573742E636F6D301E170D313830353135\
3136313533305A170D3139303531353136333533305A30163114301206035504030C0B53514C7465\
73742E636F6D30820122300D06092A864886F70D01010105000382010F003082010A0282010100B0\
918BD62519580EED40D61B28849B7DE0E36F7EB84B355F445EB9DD37C212575BF41F06AAADCF8C72\
1DE0CE583223C8D2391511AC3B09E6CAAD768EF0FEA2990501334921CEE0064CD9DB8A78C624C257\
0010BCB6565A1F6BCC95F5495A7512E8089E473E0074F03BD8C4B2FB656C26580D7BF85994477AFE\
718A577DA05B27435EF29ECA9D261F22B48D7DA9463571F4DD07527D07A9CE2D614698042B5DA34D\
88122ED482BCAC376508466370F1711746E9FF1A80BC58053137A17620A22D82E10E417CAA798299\
C627504E2AD79ACD3B1B2EBBEAD489DCED55721B03DB8715301C146ABD08C29648F4CBA30A86EAB1\
111451B8CB39382375D6B92D0AC5D10203010001A35E305C300E0603551D0F0101FF040403020780\
30130603551D25040C300A06082B0601050507030330160603551D11040F300D820B53514C746573\
742E636F6D301D0603551D0E041604144A8FF1300CBFA278AE28DB9D040899426099E975300D0609\
2A864886F70D01010B0500038201010095B2E1CCC3026660B571978E53F957DEBDEE5764E85EFCFE\
F22F457D5C161608C92E350309BA0B54298AF101E50BECFF0F43B38ED304CCA09D5D5C66E539CE80\
8132AECA48D8AECE28E053AC9EAAA26D8AF5030E49E765453E002CC542F8A85B8C4E267448131397\
B7AEAD5BDF2062B73DC83721EFC8BA56C9AE7D8EDEB5EE3BE5D51CA6ADCD42BD63A4CCEF9FD9846A\
3584896ABD093324CF677E194613E6177D56D77A0FBBA39DAE88C0AF4D8F3F9C935A29B519BA8C8E\
B5E1B43CE85BC1593AAA26B930958B2456F7AA9224A638C987E5FCAFFE90B8B7FBFD1433580E0FF0\
9B5DA6948DE2968CBD0C28B0812EFF40E285FD445F2B5C0617F55FA24BE54769
	END;

	IF (SUSER_ID(N'SQL2017-ClrStrictSecurity-TempLogin') IS NULL)
	BEGIN
		PRINT 'Temporary Login does NOT exist:';
		CREATE LOGIN [SQL2017-ClrStrictSecurity-TempLogin]
			FROM CERTIFICATE [SQL2017-ClrStrictSecurity-Cert];
	END;

	-- REVOKE UNSAFE ASSEMBLY FROM [SQL2017-ClrStrictSecurity-TempLogin];
	GRANT UNSAFE ASSEMBLY TO [SQL2017-ClrStrictSecurity-TempLogin]; -- REQUIRED!!!!

	IF (ASSEMBLYPROPERTY(N'SQL2017-ClrStrictSecurity-KeyAsm', N'MvID') IS NULL)
	BEGIN
		PRINT '	Creating Assembly that holds the Asymmetric Key...';
		CREATE ASSEMBLY [SQL2017-ClrStrictSecurity-KeyAsm]
			FROM 0x\
4D5A90000300000004000000FFFF0000B80000000000000040000000000000000000000000000000\
0000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD215468\
69732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A\
2400000000000000504500004C010300A700FB5A0000000000000000E00022200B01300000060000\
00060000000000004A25000000200000004000000000001000200000000200000400000000000000\
06000000000000000080000000020000D4D400000300608500001000001000000000100000100000\
00000000100000000000000000000000F82400004F00000000400000C00200000000000000000000\
000E000068050000006000000C000000C02300001C00000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000200000080000000000000000000000\
082000004800000000000000000000002E7465787400000050050000002000000006000000020000\
000000000000000000000000200000602E72737263000000C0020000004000000004000000080000\
000000000000000000000000400000402E72656C6F6300000C0000000060000000020000000C0000\
00000000000000000000000040000042000000000000000000000000000000002C25000000000000\
480000000200050050200000F0020000090000000000000000000000000000004023000080000000\
000000000000000000000000000000000000000000000000000000000000000042534A4201000100\
000000000C00000076342E302E33303331390000000005006C000000B4000000237E000020010000\
D000000023537472696E677300000000F00100000400000023555300F40100001000000023475549\
4400000004020000EC00000023426C6F620000000000000002000001071400000900000000FA0133\
00160000010000000400000001000000030000000300000001000000010000000000650001000000\
000006002700A00006004700A000060013008D000F00C00000000000000001000000000001000100\
090087000100110087000600190087000A002E000B00BB002E001300C4002E001B00E30004800000\
00000000000000000100000019007800000004000000000000000000000010000A00000000000000\
003C4D6F64756C653E006D73636F726C69620044656275676761626C654174747269627574650043\
6F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F\
6D7061746962696C6974794174747269627574650053514C323031375F4B657941736D2E646C6C00\
53514C323031375F4B657941736D002E63746F720053797374656D2E446961676E6F737469637300\
53797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E\
674D6F646573000000000000EFC5DFA72DA3F74692604E4A7873060A000420010108032000010520\
0101111108B77A5C561934E08980A000240000048000009400000006020000002400005253413100\
04000001000100DDDB2ECB825EA04E22A31C9968CDA19DE1B82A4C02F7135EE3B9CC250AD3ED45FC\
AAEF3BD268095A989A7554876953E47679140D0C8FC8B8F4303B267F15622A5A8537CA7A954774AA\
679861F84AEF8ED4971A9CE9F7A83875E3D1D50CDECD04E5FBFA5AC0B8CEDF56B5F03F5A1C25C98D\
244C0FEEEC67C4BA68A71017ED9AB20801000800000000001E01000100540216577261704E6F6E45\
7863657074696F6E5468726F777301080100070100000000DFE737AE95AEA54A960EDE9252898D78\
BB85513CAFEF8AD7CEBEC42B8FC62BE83F0D33720C4BE669EC0AE46680EBF35929999CDFFAC4F70C\
AEB961E78F063CBDCF8DDD981C3F5AB984C926ACF70FCED94EE619FAFBC1045462654B507BFA87EA\
196152B4E417C2FE78BBC8507ACE89A88D394700FAC4C93C20DF37FB56C2F12900000000A700FB5A\
00000000020000001C010000DC230000DC050000525344532A18F1D1A8C85F479A713567B48F76C7\
01000000433A5C436F64655C53514C43727970744578745C53514C323031375F4B657941736D5C6F\
626A5C44656275675C53514C323031375F4B657941736D2E70646200000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
0000000000000000000000000000000000000000000000002025000000000000000000003A250000\
0020000000000000000000000000000000000000000000002C250000000000000000000000005F43\
6F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002000100000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000010010000000180000800000000000000000\
00000000000001000100000030000080000000000000000000000000000001000000000048000000\
58400000640200000000000000000000640234000000560053005F00560045005200530049004F00\
4E005F0049004E0046004F0000000000BD04EFFE0000010000000000000000000000000000000000\
3F000000000000000400000002000000000000000000000000000000440000000100560061007200\
460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100\
740069006F006E00000000000000B004C4010000010053007400720069006E006700460069006C00\
650049006E0066006F000000A001000001003000300030003000300034006200300000002C000200\
0100460069006C0065004400650073006300720069007000740069006F006E000000000020000000\
300008000100460069006C006500560065007200730069006F006E000000000030002E0030002E00\
30002E003000000046001300010049006E007400650072006E0061006C004E0061006D0065000000\
530051004C0032003000310037005F004B0065007900410073006D002E0064006C006C0000000000\
2800020001004C006500670061006C0043006F007000790072006900670068007400000020000000\
4E00130001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000\
530051004C0032003000310037005F004B0065007900410073006D002E0064006C006C0000000000\
340008000100500072006F006400750063007400560065007200730069006F006E00000030002E00\
30002E0030002E003000000038000800010041007300730065006D0062006C007900200056006500\
7200730069006F006E00000030002E0030002E0030002E0030000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
0000000000000000000000000000000000000000000000000000000000000000002000000C000000\
4C350000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000068050000000202003082055C06092A86\
4886F70D010702A082054D30820549020101310B300906052B0E03021A0500304C060A2B06010401\
8237020104A03E303C3017060A2B06010401823702010F3009030100A004A2028000302130090605\
2B0E03021A0500041487BB4A91AC658C3D1AD037D33DE755ACDF31D3D2A082031830820314308201\
FCA003020102021013544116E573398548BDFCCCCC992511300D06092A864886F70D01010B050030\
163114301206035504030C0B53514C746573742E636F6D301E170D3138303531353136313533305A\
170D3139303531353136333533305A30163114301206035504030C0B53514C746573742E636F6D30\
820122300D06092A864886F70D01010105000382010F003082010A0282010100B0918BD62519580E\
ED40D61B28849B7DE0E36F7EB84B355F445EB9DD37C212575BF41F06AAADCF8C721DE0CE583223C8\
D2391511AC3B09E6CAAD768EF0FEA2990501334921CEE0064CD9DB8A78C624C2570010BCB6565A1F\
6BCC95F5495A7512E8089E473E0074F03BD8C4B2FB656C26580D7BF85994477AFE718A577DA05B27\
435EF29ECA9D261F22B48D7DA9463571F4DD07527D07A9CE2D614698042B5DA34D88122ED482BCAC\
376508466370F1711746E9FF1A80BC58053137A17620A22D82E10E417CAA798299C627504E2AD79A\
CD3B1B2EBBEAD489DCED55721B03DB8715301C146ABD08C29648F4CBA30A86EAB1111451B8CB3938\
2375D6B92D0AC5D10203010001A35E305C300E0603551D0F0101FF04040302078030130603551D25\
040C300A06082B0601050507030330160603551D11040F300D820B53514C746573742E636F6D301D\
0603551D0E041604144A8FF1300CBFA278AE28DB9D040899426099E975300D06092A864886F70D01\
010B0500038201010095B2E1CCC3026660B571978E53F957DEBDEE5764E85EFCFEF22F457D5C1616\
08C92E350309BA0B54298AF101E50BECFF0F43B38ED304CCA09D5D5C66E539CE808132AECA48D8AE\
CE28E053AC9EAAA26D8AF5030E49E765453E002CC542F8A85B8C4E267448131397B7AEAD5BDF2062\
B73DC83721EFC8BA56C9AE7D8EDEB5EE3BE5D51CA6ADCD42BD63A4CCEF9FD9846A3584896ABD0933\
24CF677E194613E6177D56D77A0FBBA39DAE88C0AF4D8F3F9C935A29B519BA8C8EB5E1B43CE85BC1\
593AAA26B930958B2456F7AA9224A638C987E5FCAFFE90B8B7FBFD1433580E0FF09B5DA6948DE296\
8CBD0C28B0812EFF40E285FD445F2B5C0617F55FA24BE54769318201CB308201C7020101302A3016\
3114301206035504030C0B53514C746573742E636F6D021013544116E573398548BDFCCCCC992511\
300906052B0E03021A0500A0783018060A2B06010401823702010C310A3008A0028000A102800030\
1906092A864886F70D010903310C060A2B060104018237020104301C060A2B06010401823702010B\
310E300C060A2B060104018237020115302306092A864886F70D0109043116041455341951608AA1\
5D67800D6B2282488D28B71645300D06092A864886F70D0101010500048201002868BB95AF8B19C6\
C137036E8D17EB70A432D598946BB35FF0D7909FDC05D71FC3DD1F7C691527FDB6B57DD8E566438B\
B7D6A73713274F8702019E3C725453A25223BBF5C0C166F56C93F417554F39D08974E6440D3ACE0A\
86F7CF484235E6738FF368C8A2076277A65202E8E401FBB99A6B57A3316C5BDDCB9BC11FAEED637E\
3D76BF68D5D49A570E1893146CFB3771F591010A8A21472323E7635B59A9057A6590BF3034E22099\
84A835865C2495D22D292DAAABB54E742173B00B266FEAD788D2409CE52017553DB989F0445D6CE1\
27755FDEF0CD139225A20111B366C49BE7513C1860F3562E2FA476DF3F30CED52EC4D4649BAC070F\
A92DE5F3AB61308E
WITH PERMISSION_SET = SAFE;
	END;

	IF (ASYMKEY_ID(N'SQL2017-ClrStrictSecurity-Key') IS NULL)
	BEGIN
		PRINT '	Creating Asymmetric Key...';
		CREATE ASYMMETRIC KEY [SQL2017-ClrStrictSecurity-Key]
			FROM ASSEMBLY [SQL2017-ClrStrictSecurity-KeyAsm];
	END;

	IF (SUSER_ID(N'SQL2017-ClrStrictSecurity-Login') IS NULL)
	BEGIN
		PRINT '	Creating permissions Login...';
		CREATE LOGIN [SQL2017-ClrStrictSecurity-Login]
			FROM ASYMMETRIC KEY [SQL2017-ClrStrictSecurity-Key];
	END;

	GRANT UNSAFE ASSEMBLY TO [SQL2017-ClrStrictSecurity-Login]; -- REQUIRED!!!!


	IF (ASSEMBLYPROPERTY(N'SQL2017-ClrStrictSecurity-KeyAsm', N'MvID') IS NOT NULL)
	BEGIN
		PRINT '	Dropping Assembly that holds the Asymmetric Key...';
		DROP ASSEMBLY [SQL2017-ClrStrictSecurity-KeyAsm];
	END;

	IF (SUSER_ID(N'SQL2017-ClrStrictSecurity-TempLogin') IS NOT NULL)
	BEGIN
		PRINT '	Dropping temporary Login...';
		DROP LOGIN [SQL2017-ClrStrictSecurity-TempLogin];
	END;

	IF (CERT_ID(N'SQL2017-ClrStrictSecurity-Cert') IS NOT NULL)
	BEGIN
		PRINT '	Dropping Certificate...';
		DROP CERTIFICATE [SQL2017-ClrStrictSecurity-Cert];
	END;
END;

--DROP LOGIN [SQL2017-ClrStrictSecurity-Login];
--DROP ASYMMETRIC KEY [SQL2017-ClrStrictSecurity-Key];


-- Verify that "clr strict security" is 1 (i.e. ON), and that TRUSTWORTHY is 0 (i.e. OFF):
EXEC sp_configure 'clr strict security';

SELECT [name], [is_trustworthy_on], [collation_name]
FROM sys.databases WHERE [database_id] = DB_ID(N'ApproveMe');


GO

CREATE ASSEMBLY [simplecrypto]
        AUTHORIZATION [dbo]
        FROM 0x\
4D5A90000300000004000000FFFF0000B80000000000000040000000000000000000000000000000\
0000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD215468\
69732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A\
2400000000000000504500004C01030098D1FD5A0000000000000000E00022200B01300000220000\
0006000000000000EA41000000200000006000000000001000200000000200000400000000000000\
040000000000000000A00000000200008A6900000300408500001000001000000000100000100000\
00000000100000000000000000000000984100004F00000000600000980300000000000000000000\
002A000068050000008000000C000000604000001C00000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000200000080000000000000000000000\
082000004800000000000000000000002E74657874000000F0210000002000000022000000020000\
000000000000000000000000200000602E7273726300000098030000006000000004000000240000\
000000000000000000000000400000402E72656C6F6300000C000000008000000002000000280000\
0000000000000000000000004000004200000000000000000000000000000000CC41000000000000\
480000000200050020270000C018000009000000000000000000000000000000E03F000080000000\
00000000000000000000000000000000000000000000000000000000000000007A02281200000A00\
000220A0860100281400000600021F222816000006002A1E027B010000042A2202037D010000042A\
1E027B020000042A2202037D020000042A1E027B030000042A2202037D030000042A1E027B040000\
042A2202037D040000042A1E027B050000042A2202037D050000042A133003004F00000001000011\
00022817000006281300000A0A062C0B7201000070731400000A7A02281B000006281300000A0B07\
2C070228210000062602020228130000062824000006281A000006000228190000060C2B00082A00\
133002001B0000000200001100020328180000060002281D000006260228190000060A2B00062A00\
13300300240000000200001100020328180000060002050428220000062602281D00000626022819\
0000060A2B00062A133002002A000000020000110002032818000006000204281C00000600022825\
0000060002281D000006260228190000060A2B00062A000013300400700000000300001100022815\
00000617FE040C082C1B72350000700228150000068C21000001281500000A731400000A7A281600\
000A0A0228150000068D220000010B06076F1700000A000272D60000700228130000068C21000001\
07281800000A281900000A281C0000060002281B0000060D2B00092A133002001C00000002000011\
00020328140000060002042816000006000228210000060A2B00062A133002002200000004000011\
00731A00000A0A066F1B00000A000203282400000626066F1C00000A690B2B00072A000013300300\
340000000500001100281D00000A02281B0000066F1E00000A0A0228170000060603731F00000A0B\
071F406F2000000A0C08281800000A0D2B00092A1B3004003C00000006000011000002281B000006\
1F2E6F2100000A0A0202281B00000616066F2200000A1F6F282300000A28140000060000DE0D2600\
72E6000070732400000A7A2A01100000000001002D2E000D17000001133004005A00000007000011\
00032C060414FE012B01170C082C04160D2B45036F2500000A046F2500000A282600000A0A160B16\
13042B1A070311046F2700000A0411046F2700000A61600B110417581304110406FE04130511052D\
DB0716FE010D2B00092A0000133003001600000002000011007E0B0000047E0C0000040228290000\
060A2B00062A0000133003000E000000020000110002020328290000060A2B00062A000013300400\
9302000008000011732C0000060A06047D12000004000216310A031631060203FE022B0117130E11\
0E2C0814130F3865020000067B12000004280100002B16FE02131011102C44007E1100000406FE06\
2D000006732900000A280200002B7E15000004252D17267E14000004FE0632000006732B00000A25\
8015000004280300002B280400002B0B002B31007E110000047E16000004252D17267E14000004FE\
0633000006732B00000A258016000004280300002B280400002B0B00078E698D210000010C161311\
2B100811110711119A8E699E1111175813111111088E69FE04131211122DE3078E698D210000010D\
1613132B0C09111311139E1113175813131113098E69FE04131411142DE71A8D220000011304732E\
00000A1305110511046F1700000A00110416911F7F5F1F1862110417911F106260110418911E6260\
110419916013061106732F00000A13071413080203FE04131511152C141107020317586F3000000A\
8D2B00000113082B08028D2B0000011308098E691759130D16131638F400000000110D16FE011317\
11172C0516130B2B0C110716110D6F3000000A130B09110B94130A08110A941759130C110C16FE01\
131811182C051613092B0E110716110C17586F3000000A13091108111607110A9A1109939D110C16\
FE01131911192C0C08110A07110A9A8E699E2B4000110C1109FE0116FE01131A111A2C220007110A\
9A110C93131B07110A9A110C07110A9A1109939D07110A9A1109111B9D0008110A8F21000001254A\
17595400110D16FE01131C111C2C09098E691759130D2B2D00110D110BFE0116FE01131D111D2C16\
0009110D94131E09110D09110B949E09110B111E9E00110D1759130D000011161758131611161108\
8E69FE04131F111F3AFBFEFFFF1108733100000A130F2B00110F2A2202281200000A002A13300400\
4C000000000000001E800B0000041F0A800C000004733200000A251672580100706F3300000A0025\
1772860100706F3300000A00251872B40100706F3300000A00251972C60100706F3300000A008011\
0000042A133003002500000009000011732E0000060A06037D13000004027B1200000406FE062F00\
0006733400000A280500002B2A3E03027C13000004283600000AFE012A2E73310000068014000004\
2A360F01283700000A6F3800000A2A0042534A4201000100000000000C00000076322E302E353037\
32370000000005006C000000E4090000237E0000500A00003808000023537472696E677300000000\
88120000E4010000235553006C1400001000000023475549440000007C1400004404000023426C6F\
620000000000000002000001571FA209090A000000FA013300160000010000002B00000008000000\
16000000330000002A0000000100000038000000080000002800000009000000020000000A000000\
130000000500000001000000030000000300000005000000000040050100000000000600BB039A06\
060062049A060600ED0246060F00BA0600000600DB03180806003003A20506009E03A20506007F03\
A20506004904A20506000104A20506001A04A20506004703A20506001C037B060600DF027B060600\
6203A20506003F0751050600C4029A060600AD02460606000103460606002306F7070A00EA044606\
0600D606F7070600D405510506005F0551050600AD009A0106003504510506000A06F70706005805\
510506009E009A010E00970051050600D90451050600B40551050600700051050600880451050600\
880751050600C80495070600DD06F7070600C9068D050600CE05510506000D0551050E005E02F905\
060054009A0106000506510500000000E4000000000001000100A10000004F02DE05000001000100\
010010007600DE0541000100120001010000EB05DE05610006002700010010004002DE0541000B00\
27000301100001000000410012002C00030110003F000000410013002E00032110008E0100004100\
140030000100D30105030100B90105030100250208030100090208030100F301080306067D010503\
56808D020B03568083020B03568092010B03568038050B0331002E01050331004A01050351800401\
08035180190108035180ED000803518066010803310071060F030600270718030600F7051D033600\
E0002603160025002A0316007D002A03000000000000C60DF206A4000100000000000000C60D0507\
01000100000000000000C60D9D04A4000200000000000000C60DAA0401000200000000000000C60D\
BF0739030300000000000000C60DCD0710000300000000000000C60DA10739030400000000000000\
C60D4D0739030400000000000000C60D560710000400000000000000C60580043903050000000000\
0000C60580043D030500000000000000C605800442030600000000000000C6058004490309000000\
00000000C6056A0739030B00000000000000C6056A078D000B00000000000000C60568054F030D00\
000000000000C605690254030E0050200000000086183906060010006F2000000000E609F206A400\
1000772000000000E609050701001000802000000000E6099D04A4001100882000000000E609AA04\
01001100912000000000E609BF0739031200992000000000E609CD0710001200A22000000000E609\
A10739031300AA20000000008108B00710001300B32000000000E6094D0739031400BB2000000000\
E609560710001400C42000000000E601800439031500202100000000E60180043D03150048210000\
0000E601800442031600782100000000E601800449031900B02100000000E6016A0739031B002C22\
00000000E6016A078D001B00542200000000E60168054F031D008422000000008100F4045A031E00\
C4220000000081005F0706001F001C2300000000E601690254031F008423000000009600A4025F03\
2100A823000000009600A40266032200C423000000009600A4026E03240063260000000086183906\
060027006C260000000091183F06770327006326000000008618390606002700C426000000008300\
16007B0327006326000000008618390606002800F526000000008300C80086032800052700000000\
91183F0677032900632600000000861839060600290011270000000083002E008C03290011270000\
0000830086008C032A00000001009704000001009704000001009704000001009704000001000205\
00000100020500000200B70400000300180700000100020500000200770700000100180700000200\
B70400000100830500000100620000000200BA000000010097040000010097040000010097040000\
0100970400000100970400000100020500000100020500000200B704000003001807000001000205\
00000200770700000100180700000200B70400000100830500000100830500000100620000000200\
BA00000001002707000001003105000002002707000001001D050000020027050000030027070000\
0100F70500000100E80400000100F70500000100F705030008000900390601001100390606001900\
39060A00290039060600310039061000390039061000410039061000490039061000510039061000\
59003906100061003906100069003906150071003906100079003906100089003906060099003906\
1A00D10039060600810039060600F90028082600010139061000F90038073800A1009D023E00A100\
E90643001901D1044900F90038074F00A90039060600A90082070600A90059065C002101D7006A00\
2101E9067000B100390676002901E9067E00F900C0048800F900E0048D0009019702930039013906\
1000F9001205A40041016405A800F9002E07AE0049017C07DF000C003906FD004901710203011400\
3906FD004901460734014901DB075A01D90039060600E10039060100E10090076D01F90039067301\
1C00390606001C00B501810124003906FD004901140896012C00EF07B1012C008D04B601F900E307\
BB0108001C006B02080020007002080024007502080028007A020E0034007F020E003800AC020E00\
3C00D9020E004000EA0221007B0070022100830038042E000B00A0032E001300A9032E001B00C803\
2E00230070022E002B00D1032E003300E3032E003B00E3032E004300E3032E004B00D1032E005300\
E9032E005B00E3032E006300E3032E006B0001042E0073002B0441007B0070024100830038046100\
7B00700261008300380481007B007002810083003804A1007B007002A10083003804C3007B007002\
E3007B00700203017B00700260027B00700280027B007002A0027B007002C0027B007002E0027B00\
700200037B00700220037B00700240037B00700260037B00700280037B00700224048B0070026404\
8B007002C4048B00700220002B002F005600600084009B00B3008901020001000300060000000907\
98030000AE0498030000D1079C030000B4079C03000072079C030000090798030000AE0498030000\
D1079C030000B4079C03000072079C03020001000300010002000300020003000500010004000500\
020005000700010006000700020007000900020008000B00010009000B00020013000D0001001400\
0D00020015000F00010016000F0002001700110001001800110002001900130001001A0013000200\
1B00150001001C001500F000260179018E01A90104800000010000000000000001000000C901DE05\
0000020000000000000000000000C001850100000000020000000000000000000000C00151050000\
0000030005000000000000000000C0017702000000000600050007000500080005005100EB005500\
1C0159004E015B0068016B00EB000000003C3E635F5F446973706C6179436C617373395F30003C47\
656E65726174653E625F5F30003C3E395F5F395F31003C47656E65726174653E625F5F395F31003C\
3E635F5F446973706C6179436C617373395F310049456E756D657261626C6560310070617373776F\
7264486173683100496E7433320050424B444632003C3E395F5F395F32003C47656E65726174653E\
625F5F395F320046756E636032004B657956616C75655061697260320044696374696F6E61727960\
320070617373776F72644861736832003C47656E65726174653E625F5F33006765745F5554463800\
3C3E39003C4D6F64756C653E0050415353574F52445F43484152535F4E554D455249430050415353\
574F52445F43484152535F4C434153450050415353574F52445F43484152535F5543415345004445\
4641554C545F4D494E5F50415353574F52445F4C454E4754480044454641554C545F4D41585F5041\
5353574F52445F4C454E4754480050415353574F52445F43484152535F5350454349414C0076616C\
75655F5F006D73636F726C6962003C3E63004E756D657269630053797374656D2E436F6C6C656374\
696F6E732E47656E6572696300416464003C53616C7453697A653E6B5F5F4261636B696E67466965\
6C64003C48617368497465726174696F6E733E6B5F5F4261636B696E674669656C64003C53616C74\
3E6B5F5F4261636B696E674669656C64003C486173686564546578743E6B5F5F4261636B696E6746\
69656C64003C506C61696E546578743E6B5F5F4261636B696E674669656C640052616E646F6D5061\
7373776F7264004943727970746F5365727669636500456E756D657261626C6500436F6D70617265\
0057686572650053797374656D2E436F726500557070657263617365004C6F776572636173650050\
61727365004372656174650047656E657261746500446562756767657242726F777361626C655374\
61746500436F6D70696C657247656E65726174656441747472696275746500477569644174747269\
627574650044656275676761626C6541747472696275746500446562756767657242726F77736162\
6C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C79\
5469746C6541747472696275746500417373656D626C7954726164656D61726B4174747269627574\
6500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C7943\
6F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F\
6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275\
746500416C6C6F775061727469616C6C795472757374656443616C6C657273417474726962757465\
00417373656D626C7950726F6475637441747472696275746500417373656D626C79436F70797269\
67687441747472696275746500506172616D417272617941747472696275746500417373656D626C\
79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174\
7472696275746500436F6D707574650042797465006765745F56616C75650076616C756500676574\
5F53616C7453697A65007365745F53616C7453697A650073616C7453697A6500496E6465784F6600\
456E636F64696E6700546F426173653634537472696E6700537562737472696E670053746F707761\
7463680063616C63756C617465486173680074657874546F48617368004D617468006765745F4C65\
6E677468006D696E4C656E677468006D61784C656E677468006C656E677468005370656369616C00\
53696D706C6543727970746F2E646C6C0053797374656D0052616E646F6D00456E756D004D696E00\
476574456C617073656454696D65466F72497465726174696F6E00697465726174696F6E00537973\
74656D2E476C6F62616C697A6174696F6E0053797374656D2E5265666C656374696F6E00496E7661\
6C69644F7065726174696F6E457863657074696F6E00466F726D6174457863657074696F6E005369\
6D706C6543727970746F0050617373776F726447726F75700053797374656D2E4C696E7100436861\
7200524E4743727970746F5365727669636550726F76696465720052616E646F6D4E756D62657247\
656E657261746F72002E63746F72002E6363746F720053797374656D2E446961676E6F7374696373\
006765745F456C61707365644D696C6C697365636F6E64730070617373776F726473005379737465\
6D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D65\
2E436F6D70696C6572536572766963657300446562756767696E674D6F646573004E756D62657253\
74796C657300526663323839384465726976654279746573004765744279746573006765745F4861\
7368497465726174696F6E73007365745F48617368497465726174696F6E73006861736849746572\
6174696F6E730067726F757073006765745F436861727300466F726D6174004F626A656374005365\
6C656374006765745F53616C74007365745F53616C7400657870616E6453616C740047656E657261\
746553616C740073616C7400436F756E7400537461727400436F6E76657274004E65787400537973\
74656D2E54657874006765745F48617368656454657874007365745F486173686564546578740067\
65745F506C61696E54657874007365745F506C61696E5465787400546F417272617900546F436861\
724172726179006765745F4B65790053797374656D2E53656375726974792E43727970746F677261\
70687900416E790053797374656D2E53656375726974790049734E756C6C4F72456D707479000000\
003350006C00610069006E0054006500780074002000630061006E006E006F007400200062006500\
200065006D0070007400790000809F430061006E006E006F0074002000670065006E006500720061\
0074006500200061002000730061006C00740020006F0066002000730069007A00650020007B0030\
007D002C002000750073006500200061002000760061006C00750065002000670072006500610074\
006500720020007400680061006E00200031002C0020007200650063006F006D006D0065006E0064\
00650064003A00200031003600000F7B0030007D002E007B0031007D000071540068006500200073\
0061006C007400200077006100730020006E006F007400200069006E00200061006E002000650078\
00700065006300740065006400200066006F0072006D006100740020006F00660020007B0069006E\
0074007D002E007B0073007400720069006E0067007D00002D610062006300640065006600670069\
006A006B006D006E006F00700071007200730074007700780079007A00002D410042004300440045\
004600470048004A004B004C004D004E00500051005200530054005700580059005A000011320033\
00340035003600370038003900001B2A0024002D002B003F005F0026003D00210025007B007D002F\
000100008B8EA25604EB3C4FA93DBBD61826D4C80004200101080320000105200101111104200101\
0E042001010205200101114905070302020E040001020E0307010E08070412511D05020E0500020E\
0E1C0400001251052001011D050500010E1D050600030E0E1C1C0507021255080320000A0907041D\
0512591D050E0500001280910520011D050E072003010E1D05080520011D05080307010804200108\
030520020E0808070002080E1180990807060808020208020320000805000208080804200103082B\
072012181D1D031D081D081D05126D0812711D030808080808020E02080208020208020202020302\
0208020B10010108151280A9011E00040A0111100C151279021511750211100E02052002011C1818\
100102151280A9011E00151280A9011E00151279021E0002090A011511750211100E0D1512790215\
11750211100E1D0319100202151280A9011E01151280A9011E00151279021E001E010B0A02151175\
0211100E1D030D1001011D1E00151280A9011E00040A011D03052002080808052001011D03071512\
650211100E0720020113001301040701121C07151279021110021210010202151280A9011E001512\
79021E0002071511750211100E042000130004200013010420001D0308B77A5C561934E08980A000\
24000004800000940000000602000000240000525341310004000001000100DDDB2ECB825EA04E22\
A31C9968CDA19DE1B82A4C02F7135EE3B9CC250AD3ED45FCAAEF3BD268095A989A7554876953E476\
79140D0C8FC8B8F4303B267F15622A5A8537CA7A954774AA679861F84AEF8ED4971A9CE9F7A83875\
E3D1D50CDECD04E5FBFA5AC0B8CEDF56B5F03F5A1C25C98D244C0FEEEC67C4BA68A71017ED9AB204\
000000000401000000040200000004030000002C610062006300640065006600670069006A006B00\
6D006E006F00700071007200730074007700780079007A002C410042004300440045004600470048\
004A004B004C004D004E00500051005200530054005700580059005A001032003300340035003600\
3700380039001A2A0024002D002B003F005F0026003D00210025007B007D002F0002060802060E03\
06111008061512650211100E04061D111008061511750211100E030612200E061512790215117502\
11100E1D030320000E0420010E0E0620030E0E08080520020E0E0E0420010808052002020E0E0420\
010E080600010E1D11100700020E081D11100800030E08081D1110030000010A2001021511750211\
100E0520010211100B20011D031511750211100E032800080328000E0801000800000000001E0100\
0100540216577261704E6F6E457863657074696F6E5468726F777301080100070100000000110100\
0C53696D706C6543727970746F000005010000000017010012436F7079726967687420C2A9202032\
30313200002901002431326638633235332D383666352D346632312D393036302D37613763333362\
616532326400000C010007312E302E302E3000000801000000000000000000004660C4159038466A\
A83DADE67F814CD22943B508BE43F1013B7F07A4E9E3AF98367ECB48E2FE0D551FEF4D72DC878206\
4A4C6F2A1AFEBB069EF0F78551F4F9EFB8281CA10ACB2DCADBAAD545145B9C72F3F19627166AA10E\
8BB753ABB256722CEFBA6C3DE93A89F6D79706EBFBF9DF4186B60B827D375D7982D5BDDA9744203B\
0000000098D1FD5A00000000020000001C0100007C4000007C22000052534453B9AC51CEC508A64E\
B715CD37A9A1569F01000000433A5C436F64655C53696D706C6543727970746F2E6E65745C737263\
5C6F626A5C44656275675C53696D706C6543727970746F2E70646200000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
0000000000000000000000000000000000000000000000000000000000000000C041000000000000\
00000000DA410000002000000000000000000000000000000000000000000000CC41000000000000\
0000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF2500200010\
00000000000000000000000000000000000000000000000000000000000001001000000018000080\
00000000000000000000000000000100010000003000008000000000000000000000000000000100\
0000000048000000586000003C03000000000000000000003C0334000000560053005F0056004500\
5200530049004F004E005F0049004E0046004F0000000000BD04EFFE000001000000010000000000\
00000100000000003F00000000000000040000000200000000000000000000000000000044000000\
0100560061007200460069006C00650049006E0066006F0000000000240004000000540072006100\
6E0073006C006100740069006F006E00000000000000B0049C020000010053007400720069006E00\
6700460069006C00650049006E0066006F0000007802000001003000300030003000300034006200\
300000001A000100010043006F006D006D0065006E00740073000000000000002200010001004300\
6F006D00700061006E0079004E0061006D006500000000000000000042000D000100460069006C00\
65004400650073006300720069007000740069006F006E0000000000530069006D0070006C006500\
430072007900700074006F0000000000300008000100460069006C00650056006500720073006900\
6F006E000000000031002E0030002E0030002E003000000042001100010049006E00740065007200\
6E0061006C004E0061006D0065000000530069006D0070006C006500430072007900700074006F00\
2E0064006C006C00000000004800120001004C006500670061006C0043006F007000790072006900\
670068007400000043006F0070007900720069006700680074002000A90020002000320030003100\
320000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300\
00000000000000004A00110001004F0072006900670069006E0061006C00460069006C0065006E00\
61006D0065000000530069006D0070006C006500430072007900700074006F002E0064006C006C00\
000000003A000D000100500072006F0064007500630074004E0061006D0065000000000053006900\
6D0070006C006500430072007900700074006F0000000000340008000100500072006F0064007500\
63007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800\
010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E00\
30002E0030002E003000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
004000000C000000EC31000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000006805000000020200\
3082055C06092A864886F70D010702A082054D30820549020101310B300906052B0E03021A050030\
4C060A2B060104018237020104A03E303C3017060A2B06010401823702010F3009030100A004A202\
80003021300906052B0E03021A050004148395D8342BFAA783538657844009D70853B8D64CA08203\
1830820314308201FCA003020102021013544116E573398548BDFCCCCC992511300D06092A864886\
F70D01010B050030163114301206035504030C0B53514C746573742E636F6D301E170D3138303531\
353136313533305A170D3139303531353136333533305A30163114301206035504030C0B53514C74\
6573742E636F6D30820122300D06092A864886F70D01010105000382010F003082010A0282010100\
B0918BD62519580EED40D61B28849B7DE0E36F7EB84B355F445EB9DD37C212575BF41F06AAADCF8C\
721DE0CE583223C8D2391511AC3B09E6CAAD768EF0FEA2990501334921CEE0064CD9DB8A78C624C2\
570010BCB6565A1F6BCC95F5495A7512E8089E473E0074F03BD8C4B2FB656C26580D7BF85994477A\
FE718A577DA05B27435EF29ECA9D261F22B48D7DA9463571F4DD07527D07A9CE2D614698042B5DA3\
4D88122ED482BCAC376508466370F1711746E9FF1A80BC58053137A17620A22D82E10E417CAA7982\
99C627504E2AD79ACD3B1B2EBBEAD489DCED55721B03DB8715301C146ABD08C29648F4CBA30A86EA\
B1111451B8CB39382375D6B92D0AC5D10203010001A35E305C300E0603551D0F0101FF0404030207\
8030130603551D25040C300A06082B0601050507030330160603551D11040F300D820B53514C7465\
73742E636F6D301D0603551D0E041604144A8FF1300CBFA278AE28DB9D040899426099E975300D06\
092A864886F70D01010B0500038201010095B2E1CCC3026660B571978E53F957DEBDEE5764E85EFC\
FEF22F457D5C161608C92E350309BA0B54298AF101E50BECFF0F43B38ED304CCA09D5D5C66E539CE\
808132AECA48D8AECE28E053AC9EAAA26D8AF5030E49E765453E002CC542F8A85B8C4E2674481313\
97B7AEAD5BDF2062B73DC83721EFC8BA56C9AE7D8EDEB5EE3BE5D51CA6ADCD42BD63A4CCEF9FD984\
6A3584896ABD093324CF677E194613E6177D56D77A0FBBA39DAE88C0AF4D8F3F9C935A29B519BA8C\
8EB5E1B43CE85BC1593AAA26B930958B2456F7AA9224A638C987E5FCAFFE90B8B7FBFD1433580E0F\
F09B5DA6948DE2968CBD0C28B0812EFF40E285FD445F2B5C0617F55FA24BE54769318201CB308201\
C7020101302A30163114301206035504030C0B53514C746573742E636F6D021013544116E5733985\
48BDFCCCCC992511300906052B0E03021A0500A0783018060A2B06010401823702010C310A3008A0\
028000A1028000301906092A864886F70D010903310C060A2B060104018237020104301C060A2B06\
010401823702010B310E300C060A2B060104018237020115302306092A864886F70D010904311604\
14377C51F6ECF1FD61874E2AD05A35DF7DB70D9F02300D06092A864886F70D010101050004820100\
07342FAD6EDE9CC487944FBA3EAAF23353DB39992205D4214B81AFF321AFC0B31E4C812EF3097939\
B529853AEFB6990F0E57AAEC3A328B37B8FAEF4ACADCB5AE0D8D3C70E2FF48A9C007D99FC72D2FC1\
A6378F09356B6FA79D49FD13889DAED1D1BEF636785267AF4CD80BE1B29FB8F702EC57211D06236B\
A195F5AEDBE6C9E7E33584F6D7171671F0B1F1414470C583536CC940B7AD21DAD3C61A20E3F9DBD9\
D095BCDD1F290FDDB0FBA0C66E42F885C767D99EEDA7510AE0C32090304CEE695AC392BF7ED4D9E3\
2116573B5338EB99126D4131DE0B1EF9A2176CEEF93787576082AEC43C7CD65D6A5D16AAAE44EDB5\
77AE59E3B9F084958A5AE663DDE6F1E2
    WITH PERMISSION_SET = SAFE;

CREATE ASSEMBLY [SQLCryptExt]
        AUTHORIZATION [dbo]
        FROM 0x\
4D5A90000300000004000000FFFF0000B80000000000000040000000000000000000000000000000\
0000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD215468\
69732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A\
2400000000000000504500004C010300B7D1FD5A0000000000000000E00022200B013000000E0000\
00060000000000001A2C000000200000004000000000001000200000000200000400000000000000\
0600000000000000008000000002000017F700000300608500001000001000000000100000100000\
00000000100000000000000000000000C82B00004F00000000400000880300000000000000000000\
0000000000000000006000000C000000902A00001C00000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000200000080000000000000000000000\
082000004800000000000000000000002E74657874000000200C000000200000000E000000020000\
000000000000000000000000200000602E7273726300000088030000004000000004000000100000\
000000000000000000000000400000402E72656C6F6300000C000000006000000002000000140000\
0000000000000000000000004000004200000000000000000000000000000000FC2B000000000000\
4800000002000500082100000809000009000000000000000000000000000000102A000080000000\
0000000000000000000000000000000000000000000000000000000000000000133004005B000000\
0100001100731100000A0A731200000A0B0314FE010D092C1B0006021F1020881300006F1300000A\
0C066F1400000A1001002B0B000602036F1500000A0C000708281600000A03281600000A73040000\
066F1700000A260713042B0011042A00133002002100000002000011000274030000020A03067B01\
000004811600000104067B0200000481160000012A2202281800000A002A5E02281800000A000002\
037D0100000402047D020000042A000042534A4201000100000000000C00000076342E302E333033\
31390000000005006C000000C0020000237E00002C0300007003000023537472696E677300000000\
9C0600000400000023555300A0060000100000002347554944000000B00600005802000023426C6F\
620000000000000002000001571502000902000000FA013300160000010000001700000003000000\
02000000040000000700000018000000100000000200000001000000030000000100000000002102\
01000000000006003401AA020600C701AA020600530078020F00CA02000006005401600306007B00\
38020600170138020600E30038020600AE01380206007A0138020600930138020600920038020600\
67008B02060045008B020600C60038020600AD00ED0106000D0331020A000201570206003900FA02\
0E002A004A0206003D03FA020A000702D9020E0001004A0200000000080000000000010001000100\
10001102470345000100010002001000EE02000045000100040006001702FA0006002403FA005020\
0000000096002E03FE000100B820000000009600170205010300E520000000008618720206000600\
EE20000000008618720210010600000001005B03000002002903000001005303020002001C020200\
03002903000001005B03000002002903090072020100110072020600190072020A00290072020600\
31007202100039007202100041007202100049007202100051007202100059007202100061007202\
1000690072021500710072021000790072021000810072021000910072020600B90072020600A900\
72020600A100E5012500A10020032C00A100E5013000B10014033600A90026003C00890072020600\
2000830002022E000B0018012E00130021012E001B0040012E00230049012E002B004E012E003300\
5F012E003B005F012E0043005F012E004B004E012E00530065012E005B005F012E0063005F012E00\
6B007D012E007300A7012E007B00B4011A0041000480000001000000000000000100000058004703\
000004000000000000000000000046001D0000000000040000000000000000000000460011000000\
00000100000000000000000000004F004A02000000000300020000000050424B444632003C4D6F64\
756C653E0053797374656D2E44617461006D73636F726C696200416464004943727970746F536572\
766963650049456E756D657261626C6500477569644174747269627574650044656275676761626C\
6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C7954\
69746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465\
005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C655665\
7273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472\
69627574650053716C46756E6374696F6E41747472696275746500417373656D626C794465736372\
697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E734174\
7472696275746500416C6C6F775061727469616C6C795472757374656443616C6C65727341747472\
696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C7943\
6F7079726967687441747472696275746500417373656D626C79436F6D70616E7941747472696275\
74650052756E74696D65436F6D7061746962696C69747941747472696275746500436F6D70757465\
0053797374656D2E52756E74696D652E56657273696F6E696E670053716C537472696E670050424B\
4446324861736800686173680053514C43727970744578742E646C6C0053797374656D0053797374\
656D2E5265666C656374696F6E0053696D706C6543727970746F004D6963726F736F66742E53716C\
5365727665722E536572766572002E63746F720053797374656D2E446961676E6F73746963730053\
797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E\
74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F64657300537973\
74656D2E446174612E53716C54797065730048617368656442797465730053797374656D2E436F6C\
6C656374696F6E73004F626A656374006F705F496D706C69636974006765745F53616C740073616C\
740050424B444632486173684C6973740041727261794C6973740053514C4372797074457874006F\
626A5465787400746578740053797374656D2E53656375726974790000000000AD00F4322744814D\
BB9540C153235DB300042001010803200001052001011111042001010E04200101020A0705125112\
550E02124D0620030E0E08080320000E0520020E0E0E05000111590E042001081C040701120C08B7\
7A5C561934E089082D9C34A378E00DFC80A000240000048000009400000006020000002400005253\
41310004000001000100DDDB2ECB825EA04E22A31C9968CDA19DE1B82A4C02F7135EE3B9CC250AD3\
ED45FCAAEF3BD268095A989A7554876953E47679140D0C8FC8B8F4303B267F15622A5A8537CA7A95\
4774AA679861F84AEF8ED4971A9CE9F7A83875E3D1D50CDECD04E5FBFA5AC0B8CEDF56B5F03F5A1C\
25C98D244C0FEEEC67C4BA68A71017ED9AB203061159060002124D0E0E0A0003011C101159101159\
07200201115911590801000800000000001E01000100540216577261704E6F6E457863657074696F\
6E5468726F77730108010007010000000004010000001001000B53514C4372797074457874000005\
010000000017010012436F7079726967687420C2A920203230313800002901002434613566626163\
642D346661372D346363662D393462632D62343163653133626565393700000C010007312E302E30\
2E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E362E310100540E\
144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E36\
2E315501000200540E1146696C6C526F774D6574686F644E616D650448617368540E0F5461626C65\
446566696E6974696F6E2548617368204E56415243484152284D4158292C2053616C74204E564152\
4348415228313629C546E9884430C3BF5CA7B766A3FAFE78362741A62F5E9A91A3FA14F43F7AE40E\
BA5BA9ECB5AD0EE03B0D623EE19A16A5FB0F4488F3CBC1A96AB653E8E7C7D3D26A9407D8316963BA\
8AF7A5C27E1A7D21E14A710FE137425B6E16B898401E91C79B4462DE798966EA3ADA4C8404A7354E\
469055FA8FB61FC3A1F647D5447D2A3F00000000B7D1FD5A00000000020000001C010000AC2A0000\
AC0C000052534453000459B870955042A83563B932AB7DB401000000433A5C436F64655C53514C43\
727970744578745C53514C43727970744578745C6F626A5C44656275675C53514C43727970744578\
742E7064620000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
0000000000000000F02B000000000000000000000A2C000000200000000000000000000000000000\
0000000000000000FC2B0000000000000000000000005F436F72446C6C4D61696E006D73636F7265\
652E646C6C0000000000FF2500200010000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000001001000000018000080\
00000000000000000000000000000100010000003000008000000000000000000000000000000100\
0000000048000000584000002C03000000000000000000002C0334000000560053005F0056004500\
5200530049004F004E005F0049004E0046004F0000000000BD04EFFE000001000000010000000000\
00000100000000003F00000000000000040000000200000000000000000000000000000044000000\
0100560061007200460069006C00650049006E0066006F0000000000240004000000540072006100\
6E0073006C006100740069006F006E00000000000000B0048C020000010053007400720069006E00\
6700460069006C00650049006E0066006F0000006802000001003000300030003000300034006200\
300000001A000100010043006F006D006D0065006E00740073000000000000002200010001004300\
6F006D00700061006E0079004E0061006D006500000000000000000040000C000100460069006C00\
65004400650073006300720069007000740069006F006E0000000000530051004C00430072007900\
700074004500780074000000300008000100460069006C006500560065007200730069006F006E00\
0000000031002E0030002E0030002E003000000040001000010049006E007400650072006E006100\
6C004E0061006D0065000000530051004C00430072007900700074004500780074002E0064006C00\
6C0000004800120001004C006500670061006C0043006F0070007900720069006700680074000000\
43006F0070007900720069006700680074002000A90020002000320030003100380000002A000100\
01004C006500670061006C00540072006100640065006D00610072006B0073000000000000000000\
4800100001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000\
530051004C00430072007900700074004500780074002E0064006C006C00000038000C0001005000\
72006F0064007500630074004E0061006D00650000000000530051004C0043007200790070007400\
4500780074000000340008000100500072006F006400750063007400560065007200730069006F00\
6E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C00\
79002000560065007200730069006F006E00000031002E0030002E0030002E003000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
002000000C0000001C3C000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
00000000000000000000000000000000000000000000000000000000000000000000000000000000\
0000000000000000000000000000000000000000000000000000000000000000
WITH PERMISSION_SET = SAFE;
GO

CREATE OR ALTER FUNCTION dbo.PBKDF2
(
    @Text NVARCHAR(MAX)
    ,@Salt NVARCHAR(200)
)
RETURNS TABLE (Hash NVARCHAR(MAX), Salt NVARCHAR(200))
AS EXTERNAL NAME [SQLCryptExt].[SQLCryptExt.PBKDF2Hash].[PBKDF2HashList]
GO

SELECT @@VERSION

EXEC sp_configure 'clr strict security';

SELECT [name], [is_trustworthy_on], [collation_name]
FROM sys.databases WHERE [database_id] = DB_ID(N'ApproveMe');

SELECT
    *
FROM
    dbo.PBKDF2('12345','50.thisisasalt')